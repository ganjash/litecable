<!DOCTYPE html>
<!-- saved from url=(0031)http://localhost:9292/rooms/201 -->
<html>
  <head>
    <script src="./sinatra_dup/assets/cable.js" type="text/javascript"></script>
  </head>
  <body>
  <script>

  var roomId = "201";
  var user = "sri";
  var wsSocket = "ws://localhost:9292/cable";
  var socketId = Date.now();
  // var socketId = '1234';

  var addMessage = function(data){
    console.log({user: data.user, message: data['message']})
  };

  ActionCable.startDebugging();
  var cable = ActionCable.createConsumer(wsSocket + '?sid=' + socketId);

  var chatChannel = cable.subscriptions.create(
    { channel: 'chat', id: roomId },
    {
      connected: function(){
        console.log("Connected");
        addMessage({ user: 'BOT', message: "I'm connected", system: true });
      },

      disconnected: function(){
        console.log("Connected");
        addMessage({ user: 'BOT', message: "Sorry, but you've been disconnected(", system: true });
      },

      received: function(data){
        console.log("Received", data);
        addMessage(data);
      }
    }
)</script></div></body></html>